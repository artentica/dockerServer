version: '3'

services:
    mariadb:
        container_name: mariadb
        image: mariadb:latest
        restart: always

        environment:
            - MYSQL_DATABASE=
            - MYSQL_USER=
            - MYSQL_PASSWORD=
            - MYSQL_ROOT_PASSWORD=

        expose:
            - "3306"

        volumes:
            - /srv/mariadb:/var/lib/mysql

    h5ai:
        container_name: h5ai
        image: clue/h5ai
        restart: always

        volumes:
            - /srv:/var/www

        expose:
            - "80"


    owncloud:
        container_name: owncloud
        image: owncloud:latest
        restart: always

        expose:
            - "80"

        volumes:
            - /srv/owncloud:/var/www/html

        links:
            - mariadb

        depends_on:
            - mariadb

    deluge:
        container_name: deluge
        image: linuxserver/deluge:latest
        restart: always

        environment:
            - PUID=0
            - PGID=0

        volumes:
            - /srv/deluge/downloads:/downloads
            - /srv/deluge/config:/config
            - /etc/localtime:/etc/localtime:ro

        expose:
            - "8112"
            - "58846"

        ports:
            - "7000-7009:7000-7009"

    sickrage:
        container_name: sickrage
        image: binhex/arch-sickrage:latest
        restart: always
        deploy:
            resources:
                limits:
                    cpus: "1"

        expose:
            - "8081"

        volumes:
            - /srv/deluge/downloads:/downloads
            - /srv/tvshow:/tvshow
            - /srv/sickrage/media:/media
            - /srv/sickrage/data:/data
            - /srv/sickrage/config:/config
            - /etc/localtime:/etc/localtime:ro

        environment:
            - PUID=0
            - GUID=0

        links:
            - deluge

        depends_on:
            - deluge

    couchpotato:
        container_name: couchpotato
        image: linuxserver/couchpotato:latest
        restart: always

        environment:
            - PGID=0
            - PUID=0

        volumes:
            - /srv/couchpotato/config:/config
              #- /srv/sickrage/movie:/movie
            - /srv/deluge/downloads:/downloads
            - /srv/couchpotato/downloads:/downloads
            - /srv/couchpotato/movies:/movies
            - /etc/localtime:/etc/localtime:ro

        expose:
            - "5050"

        links:
            - deluge

        depends_on:
            - deluge

    plex:
       container_name: plex
       image: timhaak/plex:latest
       restart: always

       volumes:
           - /srv/plex/config:/config
           - /srv/tvshow:/data/tvshows

       environment:
            - PUID=0
            - PGID=0

       expose:
           - "32400"

       ports:
           - 32400:32400/tcp
           - 1900:1900/udp
           - 8324:8324/tcp
           - 32410:32410/tcp
           - 32411:32411/tcp
           - 32412:32412/tcp
           - 32413:32413/tcp
           - 32414:32414/tcp


    caddy:
        container_name: caddy
        build: ../caddy

        image: caddy

        volumes:
            - /srv/caddy:/root/.caddy
            - /srv/www/portfolioBryan:/var/www/html


        links:
            - owncloud
            - sickrage
            - couchpotato
            - deluge
            - h5ai
            - plex

        depends_on:
            - owncloud
            - sickrage
            - couchpotato
            - deluge
            - h5ai
            - plex

        ports:
            - "80:80"
            - "443:443"

